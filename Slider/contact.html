<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/494467da2b.js" crossorigin="anonymous"></script>
    <title>Contact</title>
    <link rel="stylesheet" href="./assets/css/style.css" />
    <link rel="stylesheet" href="./assets/css/carousel.css" />
    <link href="./assets//disk/slidercaptcha.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
        .slidercaptcha {
            margin: 0 auto;
            width: 314px;
            height: 286px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.125);
            margin-top: 40px;
        }

        .slidercaptcha .card-body {
            padding: 1rem;
        }

        .slidercaptcha canvas:first-child {
            border-radius: 4px;
            border: 1px solid #e6e8eb;
        }

        .slidercaptcha.card .card-header {
            background-image: none;
            background-color: rgba(0, 0, 0, 0.03);
            font-size: 14px !important;
        }

        .refreshIcon {
            top: -54px;
        }

        @media screen and (max-width:400px) {
            .slidercaptcha {
                margin: 0 auto;
                width: inherit !important;
                height: 286px;
                border-radius: 4px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.125);
                margin-top: 40px;
            }

            .slidercaptcha canvas:first-child {
                width: 250px !important;
            }

            #captcha:nth-child(2) {
                width: 50px !important
            }

            div[id="captcha"] {
                width: inherit !important
            }

            .slidercaptcha.card .card-header {
                font-size: 11px !important;
            }
        }

        /* @media screen and (max-width: 1000px) {
            .slidercaptcha.card .card-header {
            font-size: 11px !important;
        } 
        }*/
    </style>
</head>

<body onload="initializeCaptcha()">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <div class="w-sm-60">
                <a href="/"><img class="h-25 w-25 " src="./assets/Images/logo1.png" alt="Logo"></a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 gap-3">
                    <li class="nav-item">
                        <a class="nav-link " href="./about.html">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="./contact.html">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="my-container">
        <div class="bg-img p-sm-5 p-4">
            <div class="d-flex justify-content-center flex-column m-auto">
                <div class="row mx-0 justify-content-center w-100">
                    <div class="col-md-8 col-lg-6  col-12 mx-0 bg-lightBlack p-4 rounded-3">
                        <form id="emailForm" action="http://localhost:4000/api/v1/users/sendEmail" method="post">
                            <div class="row mb-4">
                                <div class="col-sm-6 mb-sm-0 mb-4 w-full">
                                    <input id="firstName" type="text" class="w-100 form-control"
                                        placeholder="First Name" />
                                </div>
                                <div class="col-sm-6 w-full">
                                    <input id="lastName" type="text" class="w-100 form-control"
                                        placeholder="Last Name" />
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-12">
                                    <input id="email" type="text" class="w-100 form-control" placeholder="Email" />
                                </div>
                            </div>
                            <div class="row mb-4">
                                <div class="col-3 pe-0 w-full"> <input id="areaCode" type="text"
                                        class="w-100 form-control" placeholder="Area Code" />
                                </div>
                                <div class="dash col-1 p-0 d-flex justify-content-center">_</div>
                                <div class="col-8 ps-0 w-full"> <input id="phoneNumber" type="text"
                                        class="w-100 form-control" placeholder="Phone Number" />
                                </div>
                            </div>
                            <div class="row mb-4">
                                <div class="col-12">
                                    <input id="company" type="text" class="w-100 form-control" placeholder="Company" />
                                </div>
                            </div>
                            <div class="row mb-4">
                                <div class="col-12">

                                    <input id="subject" type="text" class="w-100 form-control" placeholder="Subject" />
                                </div>
                            </div>
                            <div class="row mb-4">
                                <div class="col-12 mb-3">
                                    <textarea id="details" class=" w-100 form-control" rows="4" cols="50"
                                        placeholder="Details"></textarea>
                                </div>
                                <div>
                                    <label class="form-label">
                                        <input type="checkbox" />
                                        <span>
                                            Send a copy of this message to yourself:
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="pwd" class="fw-bold">Captcha:</label>
                                <div class="slidercaptcha card">
                                    <div class="card-header">
                                        <span>Complete the security check</span>
                                    </div>
                                    <div class="card-body">
                                        <div id="captcha"></div>
                                    </div>
                                </div>
                                <!--<div class="row">
                                    <div class="col-10">
                                        <input type="text" name="maincaptcha" readonly class="form-control"
                                            id="mainCaptcha" />
                                    </div>
                                    <div class="col-2 d-flex justify-content-center align-items-center">
                                        <button class="btn btn-success btn-sm" onclick="generateCaptcha(event);"
                                            id="refresh"><i class="fa fa-refresh" style="font-size:17px"></i></button>
                                    </div>
                                </div> -->
                            </div>
                            <!-- <div class="mb-3">
                                <label for="pwd" class="fw-bold">Enter Captcha:</label>
                                <div class="row">
                                    <div class="col-sm-10">
                                        <input type="text" name="checkcaptcha" class="form-control" id="txtInput" />
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <span id="error" style="color:red;"></span>
                                <span id="success" style="color:green;"></span>
                            </div> -->
                            <button type="submit" class="btn btn-success px-4 py-2" id="submitBtn"
                                disabled>Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var menu_btn = document.querySelector("#menu-btn");
        var sidebar = document.querySelector("#sidebar");
        var container = document.querySelector(".my-container");
        menu_btn.addEventListener("click", () => {
            sidebar.classList.toggle("active-nav");
            container.classList.toggle("active-cont");
        });
    </script>
    <script src="./assets/disk/longbow.slidercaptcha.min.js"></script>
    <!-- <script>
        var captcha = sliderCaptcha({
            id: 'captcha',
            repeatIcon: 'fa fa-redo',
            onSuccess: function () {
                captcha.stop(); // Stop the captcha interaction
                alert('Captcha successfully completed!');
            }
        });

    </script> -->
    <script>
        document.getElementById('emailForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent form submission

            // Retrieve form data
            var firstname = document.getElementById('firstName').value;
            var lastname = document.getElementById('lastName').value;
            var email = document.getElementById('email').value;
            var areaCode = document.getElementById('areaCode').value;
            var phoneNumber = document.getElementById('phoneNumber').value;
            var company = document.getElementById('company').value;
            var subject = document.getElementById('subject').value;
            var details = document.getElementById('details').value;

            // Create the email body
            var emailBody = "First Name: " + firstname + "\n";
            emailBody += "Last Name: " + lastname + "\n";
            emailBody += "Email: " + email + "\n";
            emailBody += "Phone Number: " + areaCode + "-" + phoneNumber + "\n";
            emailBody += "Company: " + company + "\n";
            emailBody += "Subject: " + subject + "\n";
            emailBody += "Details: " + details + "\n";
            console.log(emailBody);
            // Create the AJAX request
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:4000/api/v1/users/sendEmail');
            xhr.setRequestHeader('Content-Type', 'application/json');

            // Send the form data as JSON in the request body
            xhr.send(JSON.stringify({
                firstname: firstname,
                lastname: lastname,
                email: email,
                areaCode: areaCode,
                phoneNumber: phoneNumber,
                company: company,
                subject: subject,
                details: details
            }));

            // Handle the AJAX response
            xhr.onload = function () {
                if (xhr.status === 200) {
                    // Request succeeded, show success message
                    alert('Email sent successfully!');
                    document.getElementById('emailForm').reset(); // Reset the form
                } else {
                    // Request failed, show error message
                    alert('Failed to send email. Please try again later.');
                }
            };
        });


        var captcha = sliderCaptcha({
            id: 'captcha',
            repeatIcon: 'fa fa-redo',
            onSuccess: function () {
                // captcha.stop(); // Stop the captcha interaction
                alert('Captcha successfully completed!');
                var submitBtn = document.getElementById('submitBtn');
                submitBtn.removeAttribute('disabled')
            },
            onFail: function () {
                alert('Captcha Failed!');
                var submitBtn = document.getElementById('submitBtn');
                submitBtn.setAttribute('disabled', true);
            },
            onRefresh: function () {
                isCaptchaCompleted = false; // Set the global variable to false when the captcha is refreshed
                var submitButton = document.getElementById('submitBtn');
                submitButton.disabled = true; // Disable the submit button when the captcha is refreshed
            }
        });
    </script>

    <script>
        // Function to check if all required fields are filled
        function areFieldsFilled() {
            var firstName = document.getElementById('firstName').value;
            var lastName = document.getElementById('lastName').value;
            var email = document.getElementById('email').value;
            var areaCode = document.getElementById('areaCode').value;
            var phoneNumber = document.getElementById('phoneNumber').value;
            var subject = document.getElementById('subject').value;
            var details = document.getElementById('details').value;

            // Check if all required fields are filled
            if (
                firstName.trim() === '' ||
                lastName.trim() === '' ||
                email.trim() === '' ||
                areaCode.trim() === '' ||
                phoneNumber.trim() === '' ||
                subject.trim() === '' ||
                details.trim() === ''
            ) {
                return false; // Return false if any required field is empty
            }

            return true; // All required fields are filled
        }

        // Bind the areFieldsFilled function to the input event of each required field
        var requiredFields = document.querySelectorAll('#firstName, #lastName, #email, #areaCode, #phoneNumber, #subject, #details');
        requiredFields.forEach(function (field) {
            field.addEventListener('input', function () {
                var submitButton = document.getElementById('submitBtn');
                submitButton.disabled = areFieldsFilled(); // Enable or disable the submit button based on the result of areFieldsFilled
            });
        });

    // Rest of your code...
    </script>

</body>

</html>